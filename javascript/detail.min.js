function detailChangeZoom(e){var t=document.getElementById("movie"),i=document.getElementById("preview-box");null==e&&(e=document.getElementById("zoom-slider").value/100),detailCurValue=e,detailSetSizeFromMovieSize(t,e),i.style.display="none",t.style.visibility="visible",detailResponsive?t.offsetWidth>825&&(detailStripResponsiveClasses(),detailResponsive=!1):t.offsetWidth<=825&&(detailAddResponsiveClasses(),detailResponsive=!0)}function detailPreview(){if(detailMouseDown){document.getElementById("movie");detailSetSizeFromMovieSize(document.getElementById("preview-box"),document.getElementById("zoom-slider").value/100)}}function detailHideGame(){var e=document.getElementById("movie");document.getElementById("preview-box").style.display="block",e.style.visibility="hidden"}function detailEnsureValue(){detailMouseDown?preview():document.getElementById("zoom-slider").value=100*detailCurValue}function detailStripResponsiveClasses(){for(var e=Array.prototype.slice.call(document.getElementsByClassName("responsive"),0),t=0;t<e.length;t++)e[t].classList.remove("responsive"),e[t].classList.add("was-responsive")}function detailAddResponsiveClasses(){for(var e=Array.prototype.slice.call(document.getElementsByClassName("was-responsive"),0),t=0;t<e.length;t++)e[t].classList.add("responsive"),e[t].classList.remove("was-responsive")}function detailShrink(){document.getElementById("movie");detailCurValue-.25>.5?detailCurValue-=.25:detailCurValue=.5,detailChangeZoom(detailCurValue),detailEnsureValue()}function detailGrow(){document.getElementById("movie");detailCurValue+.25<1.75?detailCurValue+=.25:detailCurValue=1.75,detailChangeZoom(detailCurValue),detailEnsureValue()}function detailFullscreen(){document.getElementById("movie");var e=document.createElement("div");e.style.position="fixed",e.style.width="1px",e.style.height="1px",e.style.bottom="0",e.style.right="0",e.style.visibility="hidden",document.getElementsByClassName("page")[0].appendChild(e);var t=e.offsetTop+1;e.style.position="absolute";var i=e.offsetLeft+1,n=t/detailOriginalHeight,a=(i-10)/detailOriginalWidth;a<n&&(n=a),detailChangeZoom(n),window.scrollTo(document.getElementById("movie-container").offsetLeft-5,209),detailEnsureValue(),e.parentNode.removeChild(e)}function detailSetSizeFromMovieSize(e,t){e.style.width=(detailOriginalWidth*t).toString().concat("px"),e.style.height=(detailOriginalHeight*t).toString().concat("px")}function detailSetTotalStars(e,t){var i=document.getElementById(t);i.innerHTML="",e=parseFloat(e);var n=22*Math.max(0,Math.min(5,e)),a=document.createElement("span");a.style.width=n.toString().concat("px"),i.appendChild(a)}function detailRate(e,t,i){if(!(isNaN(Number(e))||Number(e)<0||Number(e)>5)){var n=document.getElementById("show-rating-normal"),a=document.getElementById("show-rating-loading");a.style.display="block",n.style.display="none";var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState&&200==l.status)try{var t=JSON.parse(l.responseText),i=t.status;"failure"!=i||t.your_rating?(document.getElementsByClassName("detail-your-rating")[0].innerHTML="<span class='detail-stars' id='your-stars'></span>",a.style.display="none",n.style.display="inline","failure"==i?(detailSetTotalStars(t.your_rating,"your-stars"),document.getElementsByClassName("detail-thanks-for-voting")[0].innerHTML=t.message):(detailSetTotalStars(e,"your-stars"),detailSetTotalStars(t.rating,"total-stars"),voteStr=" vote",1!=t.votes&&(voteStr=" votes"),document.getElementsByClassName("detail-total-votes")[0].innerHTML=t.votes+voteStr),document.getElementsByClassName("detail-thanks-for-voting")[0].style.display="block"):a.innerHTML=t.message}catch(e){console.log(e),a.innerHTML="Sorry, an error occured while trying to process your vote. Please try again later."}},l.open("GET","/ws/rating.php?id="+i+"&rating="+e+"&type="+t,!0),l.send()}}var detailResponsive=!0,detailCurValue=1,detailMouseDown=0,detailOriginalWidth,detailOriginalHeight;document.addEventListener("DOMContentLoaded",function(){try{document.body.onmousedown=function(){++detailMouseDown},document.body.onmouseup=function(){--detailMouseDown};var e=window.location.pathname.split("/");if("download"==e[1])return;logInteraction(e[1],e[2]),"range"!=document.getElementById("zoom-slider").type&&(document.getElementById("zoom-slider").style.display="none",document.getElementById("full").style.display="none",document.getElementById("shrink").style.display="inline-block",document.getElementById("grow").style.display="inline-block");var t=document.getElementById("movie");detailOriginalWidth=parseInt(t.style.width),detailOriginalHeight=parseInt(t.style.height);var i=document.getElementById("zoom-slider");i.onmousedown=detailHideGame,i.onmouseup=function(){detailChangeZoom()},i.onchange=detailEnsureValue,i.oninput=detailPreview,document.getElementById("full").onclick=detailFullscreen,document.getElementById("shrink").onclick=detailShrink,document.getElementById("grow").onclick=detailGrow;for(var n=document.querySelectorAll(".detail-star"),a=0;a<n.length;a++)n[a].onclick=function(){detailRate(this.getAttribute("data-value"),e[1],this.parentNode.getAttribute("data-id"))};var l=new XMLHttpRequest,o=document.querySelector(".detail-similar-items-placeholder");l.onreadystatechange=function(){if(4==l.readyState)try{var e=JSON.parse(l.responseText);o.innerHTML=e.content}catch(e){}},l.open("GET","/ws/load_similar.php?type="+e[1]+"&id="+o.getAttribute("data-id"),!0),l.send()}catch(e){}},!1);