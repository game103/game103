var game103AccountID=null,game103AccountUsername=null,accountErrorMessage="Sorry, an error has occured",accountSuccessfullyUpdatedMessage="Your account has been successfully updated",accountLoggedInMessage="You have logged in",accountLoggedOutMessage="You have logged out",accountEmailSentMessage="Please check your inbox for an email to update your account",accountNoAccountFoundMessage="Sorry, no account was found",accountSuccessfullyMergedMessage="Your account was successfully merged";function accountDisableButtons(){var e=document.querySelector("#login"),c=document.querySelector("#logout"),a=document.querySelector("#update"),t=document.querySelector("#recover"),s=document.querySelector("#merge");e.onclick=null,c.onclick=null,a.onclick=null,t.onclick=null,s.onclick=null,e.style.opacity="0.5",c.style.opacity="0.5",a.style.opacity="0.5",t.style.opacity="0.5",s.style.opacity="0.5"}function accountloginOnLoad(){accountDisableButtons();var e=document.querySelector("#id").value;accountLoginAccountID(document.querySelector("#id2").value,function(){accountLoginAccountID(e,function(){accountDisplayMessage(accountNoAccountFoundMessage,"failure")})})}function accountLoginAccountID(a,t){accountGetUsername(a,function(e){try{var c=JSON.parse(e);c.id?(game103AccountID=a,game103AccountUsername=c.username,document.querySelector("#username").value=c.username,document.querySelector("#email").value=c.email,accountFillInUsername(),accountDisplayMessage(accountLoggedInMessage,"success")):t()}catch(e){accountDisplayMessage(accountErrorMessage,"failure")}accountEnableButtons()},function(){accountDisplayMessage(accountErrorMessage,"failure"),accountEnableButtons()})}function accountFillInUsername(){for(var e=document.querySelectorAll(".current-account"),c=0;c<e.length;c++)e[c].innerText=game103AccountUsername}function accountEnableButtons(){var e=document.querySelector("#login"),c=document.querySelector("#logout"),a=document.querySelector("#update"),t=document.querySelector("#recover"),s=document.querySelector("#merge-section"),n=document.querySelector("#merge");e.style.opacity=1,c.style.opacity=1,a.style.opacity=1,t.style.opacity=1,n.style.opacity=1,game103AccountID?(e.style.display="none",t.style.display="none",a.style.display="block",c.style.display="block",s.style.display="block",n.onclick=function(){if(accountHideMessage(),game103AccountID){var e=document.querySelector("#username-merge").value,c=document.querySelector("#password-merge").value;accountDisableButtons(),accountMerge(game103AccountID,e,c,function(e){try{var c=JSON.parse(e);"success"==c.status?(document.querySelector("#username-merge").value="",document.querySelector("#password-merge").value="",accountDisplayMessage(accountSuccessfullyMergedMessage,c.status)):accountDisplayMessage(c.message,c.status)}catch(e){accountDisplayMessage(accountErrorMessage,"failure")}accountEnableButtons()},function(){accountDisplayMessage(accountErrorMessage,"failure"),accountEnableButtons()})}},a.onclick=function(){if(accountHideMessage(),game103AccountID){var e=document.querySelector("#username").value,c=document.querySelector("#password").value,a=document.querySelector("#email").value;accountDisableButtons(),accountUpdateUser(game103AccountID,e,c,a,function(e){try{var c=JSON.parse(e);"success"==c.status?accountDisplayMessage(accountSuccessfullyUpdatedMessage,c.status):accountDisplayMessage(c.message,c.status)}catch(e){accountDisplayMessage(accountErrorMessage,"failure")}accountEnableButtons()},function(){accountDisplayMessage(accountErrorMessage,"failure"),accountEnableButtons()})}},c.onclick=function(){document.querySelector("#username").value="",document.querySelector("#password").value="",document.querySelector("#email").value="",accountDisplayMessage(accountLoggedOutMessage,"success"),game103AccountID=game103AccountID=null,accountEnableButtons()}):(a.style.display="none",c.style.display="none",s.style.display="none",e.style.display="block",t.style.display="block",e.onclick=function(){accountHideMessage();var a=document.querySelector("#username").value,e=document.querySelector("#password").value;accountDisableButtons(),accountLoginUser(a,e,function(e){try{var c=JSON.parse(e);"success"==c.status?(game103AccountID=c.id,game103AccountUsername=a,accountFillInUsername(),accountDisplayMessage(accountLoggedInMessage,c.status)):accountDisplayMessage(c.message,c.status)}catch(e){accountDisplayMessage(accountErrorMessage,"failure")}accountEnableButtons()},function(){accountDisplayMessage(accountErrorMessage,"failure"),accountEnableButtons()})},t.onclick=function(){accountHideMessage();var e=document.querySelector("#email").value;accountDisableButtons(),accountRecoverAccount(e,function(e){try{var c=JSON.parse(e);"success"==c.status?accountDisplayMessage(accountEmailSentMessage,c.status):accountDisplayMessage(c.message,c.status)}catch(e){accountDisplayMessage(accountErrorMessage,"failure")}accountEnableButtons()},function(){accountDisplayMessage(accountErrorMessage,"failure"),accountEnableButtons()})})}function accountDisplayMessage(e,c){var a=document.querySelector(".admin-error-message, .admin-success-message");"success"==c?(a.classList.remove("admin-error-message"),a.classList.add("admin-success-message")):(a.classList.remove("admin-success-message"),a.classList.add("admin-error-message")),a.innerHTML=e,a.style.display="block"}function accountHideMessage(){document.querySelector(".admin-error-message, .admin-success-message").style.display="none"}function accountUpdateUser(e,c,a,t,s,n){accountMakeRequest("POST","/ws/scores/update_user.php",{id:e,username:c,password:a,email:t},s,n)}function accountLoginUser(e,c,a,t){accountMakeRequest("POST","/ws/scores/login.php",{username:e,password:c},a,t)}function accountRecoverAccount(e,c,a){accountMakeRequest("POST","/ws/scores/recover_account.php",{email:e},c,a)}function accountMerge(e,c,a,t,s){accountMakeRequest("POST","/ws/scores/merge_accounts.php",{id:e,username:c,password:a},t,s)}function accountGetUsername(e,c,a){accountMakeRequest("GET","/ws/scores/get_user.php",{id:e},c,a)}function accountMakeRequest(e,c,a,t,s){for(var n=Object.keys(a),o=[],u=0;u<n.length;u++)o.push(n[u]+"="+a[n[u]]);"GET"==e&&n.length&&(c=c+"?"+o.join("&"));var r=new XMLHttpRequest;r.open(e,c,!0),"POST"==e&&n.length&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){4==this.readyState&&(200==this.status?t&&t(this.responseText):s&&s())},"POST"==e&&o.length?r.send(o.join("&")):r.send()}document.addEventListener("DOMContentLoaded",function(){document.querySelector("#id")?accountloginOnLoad():accountEnableButtons()});